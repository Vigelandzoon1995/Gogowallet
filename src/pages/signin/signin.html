<ion-content padding>
	<video webkit-playsinline playsinline muted autoplay loop poster="../../assets/imgs/bg2.png">
		<source src="../../assets/video/vid1.mp4" type='video/mp4; codecs="h.264"'>
		<source src="../../assets/video/vid1.webm" type='video/webm; codecs="vp8,vorbis"'>
	</video>

	<h1 class="title">Go Go Wallet</h1>

	<form novalidate [formGroup]="loginForm">
		<!-- Form when no user is locally saved -->
		<ng-container *ngIf="!usePinForm">
			<ion-row>
				<ion-col>
					<ion-list inset>
						<ion-item class="transparent-input">
							<ion-label floating>Email</ion-label>
							<ion-input type="email" [(ngModel)]="emailInput" formControlName="email"></ion-input>
						</ion-item>

						<!-- Email error-->
						<ion-item no-lines no-padding class="error error-padding" *ngIf="(loginForm.get('email').hasError('required') || loginForm.get('email').hasError('email')) && loginForm.get('email').touched">
							<span *ngIf="loginForm.get('email').hasError('required') && loginForm.get('email').hasError('email') && loginForm.get('email').touched">
								* E-mail is required.
							</span>
							<span *ngIf="!loginForm.get('email').hasError('required') && loginForm.get('email').hasError('email') && loginForm.get('email').touched">
								* Please enter a valid e-mail.
							</span>
						</ion-item>

						<ion-item class="transparent-input">
							<ion-label floating>Password</ion-label>
							<ion-input type="password" [(ngModel)]="passwordInput" formControlName="password"></ion-input>
						</ion-item>

						<!-- Password error-->
						<ion-item no-lines no-padding class="error error-padding" *ngIf="loginForm.get('password').hasError('required') && loginForm.get('password').touched">
							<span *ngIf="loginForm.get('password').hasError('required') && loginForm.get('password').touched">
								* Password is required.
							</span>
						</ion-item>

						<div hidden></div>
					</ion-list>
				</ion-col>
			</ion-row>
		</ng-container>

		<!-- Form when user is locally saved and wants to use pin to login -->
		<ng-container *ngIf="usePinForm && currentUser">
			<ion-row>
				<ion-col>
					<ion-list inset>
						<ion-item class="transparent-input text-center" no-lines>
							<img class="profile small" [src]="currentUser.profile_picture" (click)="navigateToEditProfile()" *ngIf="currentUser.profile_picture">
							<h2>Welcome back, {{ currentUser.first_name }}</h2>
						</ion-item>

						<ion-item class="transparent-input">
							<ion-label floating>{{ usePin == true ? 'PIN' : 'Password'}}</ion-label>
							<ion-input class="pin-mask" [type]="usePin ? 'tel' : 'password'" [(ngModel)]="pinCodeInput" formControlName="pinpass"></ion-input>
						</ion-item>

						<!-- PIN/Password error-->
						<ion-item class="
							 error" no-lines *ngIf="(loginForm.get('pinpass').hasError('required') || loginForm.get('pinpass').hasError('maxlength') || loginForm.get('pinpass').hasError('minlength') || loginForm.get('pinpass').hasError('pattern')) && loginForm.get('pinpass').touched">
							<span *ngIf="loginForm.get('pinpass').hasError('required') && loginForm.get('pinpass').touched">
								PIN is required.
							</span>
							<span *ngIf="loginForm.get('pinpass').hasError('minlength') && loginForm.get('pinpass').touched && usePin">
								PIN must contain at least 4 numbers.
							</span>
							<span *ngIf="loginForm.get('pinpass').hasError('maxlength') && loginForm.get('pinpass').touched && usePin">
								PIN cannot contain more than 10 numbers.
							</span>
							<span *ngIf="loginForm.get('pinpass').hasError('pattern') && loginForm.get('pinpass').touched && usePin">
								PIN can only exist out of numbers.
							</span>
							<span *ngIf="loginForm.get('pinpass').hasError('required') && loginForm.get('pinpass').touched && !usePin">
								Password is required.
							</span>
							<span *ngIf="loginForm.get('pinpass').hasError('hasPassed') && loginForm.get('pinpass').touched && !usePin">
								A password must contain at least:
								<br />10 characters
								<br />2 numbers
								<br />1 uppercase and lowercase characters
								<br />1 special character
							</span>
						</ion-item>

						<div hidden></div>
					</ion-list>
				</ion-col>
			</ion-row>
		</ng-container>

		<ion-row text-center>
			<ion-col>
				<button ion-button full round class="login-btn" type="button" [disabled]="!loginForm.valid" (click)="signIn()">Login</button>
			</ion-col>
		</ion-row>

		<ion-row text-center>
			<ion-col *ngIf="usePinForm">
				<button ion-button clear class="register-link" type="button" (click)="usePassword()" *ngIf="usePin">Use password</button>
				<button ion-button clear class="register-link" type="button" (click)="usePIN()" *ngIf="!usePin">Use PIN</button>
				<button ion-button clear class="small-link" type="button" (click)="navigateToReset()">Forgot Password?</button>
			</ion-col>
			<ion-col *ngIf="!usePinForm">
				<button ion-button clear class="register-link" type="button" (click)="navigateToRegister()">Register</button>
				<button ion-button clear class="small-link" type="button" (click)="navigateToReset()">Forgot Password?</button>
			</ion-col>
		</ion-row>
	</form>
</ion-content>
